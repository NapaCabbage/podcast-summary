# Nginx 配置 — 播客纪要静态网站
# 使用前替换 YOUR_DOMAIN 为你的实际域名
#
# 部署步骤：
#   cp deploy/nginx.conf /etc/nginx/sites-available/podcast
#   ln -s /etc/nginx/sites-available/podcast /etc/nginx/sites-enabled/podcast
#   nginx -t && systemctl reload nginx
#   certbot --nginx -d YOUR_DOMAIN   # 自动申请 SSL 并修改此文件

server {
    listen 80;
    server_name YOUR_DOMAIN;

    # Certbot 会自动在这里插入 HTTPS 重定向
    # 申请 SSL 后保持此 server 块用于重定向

    root /opt/podcast-summary/output;
    index index.html;

    # 静态文件缓存
    location ~* \.(html|css|js)$ {
        expires 1h;
        add_header Cache-Control "public, no-transform";
    }

    # 404 跳回首页
    error_page 404 /index.html;

    # 禁止访问数据目录
    location ~ ^/(raw|summaries|prompts|scrapers)/ {
        deny all;
        return 404;
    }

    # 访问日志
    access_log /var/log/nginx/podcast_access.log;
    error_log  /var/log/nginx/podcast_error.log;
}

# HTTPS — certbot 申请 SSL 后自动生成此块，无需手动填写
# server {
#     listen 443 ssl;
#     server_name YOUR_DOMAIN;
#     ...
# }
